"use strict";(self.webpackChunkjugendkompass=self.webpackChunkjugendkompass||[]).push([[3328],{73328:function(t,e,i){i.r(e),i.d(e,{PostPageModule:function(){return z}});var o=i(38583),n=i(90665),s=i(94490),a=i(9451),r=i(64762),l=i(96698),c=i(56818),d=i(68442),u=i(8078),p=i(69526),h=i(60055),f=i(76321),g=i(33018),x=i(38605),Z=i(4315),m=i(49860),k=i(28676);const v=["backButton"];function b(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",14),g.NdJ("click",function(){return g.CHM(t),g.oxw(),g.MAs(8).click()}),g._UZ(1,"ion-icon",15),g.qZA()}}function _(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",14),g.NdJ("click",function(){return g.CHM(t),g.oxw().share()}),g._UZ(1,"ion-icon",16),g.qZA()}}function U(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-button",17),g.NdJ("click",function(){return g.CHM(t),g.oxw().setPostFavorite()}),g._UZ(1,"ion-icon",18),g.qZA()}if(2&t){const t=g.oxw();g.Q6J("disabled",!(null!=t.post&&t.post.id)),g.xp6(1),g.Q6J("name",null!=t.post&&t.post.isFavorite?"star":"star-outline")}}function A(t,e){if(1&t&&g._UZ(0,"img",26),2&t){const t=g.oxw(2);g.Q6J("src",t.post.base64Img?t.post.base64Img:t.post.postImg.source_url,g.LSH)}}function w(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"a",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.openFilteredList(e.post.ausgabe)}),g._uU(1),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.ausgabe.name)}}function y(t,e){if(1&t&&(g.TgZ(0,"a",29),g._uU(1),g.qZA()),2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.ausgabe.name)}}function C(t,e){if(1&t&&(g.TgZ(0,"p",27),g.YNc(1,w,2,1,"a",8),g.YNc(2,y,2,1,"a",28),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",t.online),g.xp6(1),g.Q6J("ngIf",!t.online)}}function I(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"a",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.openFilteredList(e.post.rubrik)}),g._uU(1),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.rubrik.name)}}function P(t,e){if(1&t&&(g.TgZ(0,"a",29),g._uU(1),g.qZA()),2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.rubrik.name)}}function S(t,e){if(1&t&&(g.TgZ(0,"p",27),g.YNc(1,I,2,1,"a",8),g.YNc(2,P,2,1,"a",28),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",t.online),g.xp6(1),g.Q6J("ngIf",!t.online)}}function T(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"a",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.openFilteredList(e.post.ausgabe)}),g._uU(1),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.ausgabe.name)}}function q(t,e){if(1&t&&(g.TgZ(0,"a",29),g._uU(1),g.qZA()),2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.ausgabe.name)}}function J(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"a",14),g.NdJ("click",function(){g.CHM(t);const e=g.oxw(3);return e.openFilteredList(e.post.rubrik)}),g._uU(1),g.qZA()}if(2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.rubrik.name)}}function O(t,e){if(1&t&&(g.TgZ(0,"a",29),g._uU(1),g.qZA()),2&t){const t=g.oxw(3);g.xp6(1),g.Oqu(t.post.rubrik.name)}}function M(t,e){if(1&t&&(g.TgZ(0,"p",27),g.YNc(1,T,2,1,"a",8),g.YNc(2,q,2,1,"a",28),g._uU(3," | "),g.YNc(4,J,2,1,"a",8),g.YNc(5,O,2,1,"a",28),g.qZA()),2&t){const t=g.oxw(2);g.xp6(1),g.Q6J("ngIf",t.online),g.xp6(1),g.Q6J("ngIf",!t.online),g.xp6(2),g.Q6J("ngIf",t.online),g.xp6(1),g.Q6J("ngIf",!t.online)}}function N(t,e){if(1&t&&(g.TgZ(0,"div"),g.TgZ(1,"ion-card"),g.TgZ(2,"div",19),g.YNc(3,A,1,1,"img",20),g.qZA(),g.TgZ(4,"ion-card-content",21),g.TgZ(5,"h2"),g._uU(6),g.qZA(),g.TgZ(7,"ion-text",22),g.TgZ(8,"div",23),g.YNc(9,C,3,2,"p",24),g.YNc(10,S,3,2,"p",24),g.YNc(11,M,6,4,"p",24),g.qZA(),g.qZA(),g.qZA(),g.qZA(),g._UZ(12,"div",25),g.qZA()),2&t){const t=g.oxw();g.xp6(3),g.Q6J("ngIf",t.post.postImg||t.post.base64Img),g.xp6(3),g.Oqu(t.post.title),g.xp6(3),g.Q6J("ngIf",t.post.ausgabe&&!t.post.rubrik),g.xp6(1),g.Q6J("ngIf",!t.post.ausgabe&&t.post.rubrik),g.xp6(1),g.Q6J("ngIf",t.post.ausgabe&&t.post.rubrik),g.xp6(1),g.Udp("font-size",t.textSize,"px"),g.Q6J("innerHTML",t.post.content,g.oJD)}}function F(t,e){1&t&&(g.TgZ(0,"div"),g.TgZ(1,"div",30),g.TgZ(2,"p"),g._UZ(3,"ion-skeleton-text",31),g._UZ(4,"ion-skeleton-text",32),g._UZ(5,"ion-skeleton-text",33),g._UZ(6,"ion-skeleton-text",31),g._UZ(7,"ion-skeleton-text",34),g._UZ(8,"ion-skeleton-text",35),g._UZ(9,"ion-skeleton-text",31),g._UZ(10,"ion-skeleton-text",36),g._UZ(11,"ion-skeleton-text",35),g._UZ(12,"ion-skeleton-text",37),g._UZ(13,"ion-skeleton-text",31),g._UZ(14,"ion-skeleton-text",32),g._UZ(15,"ion-skeleton-text",33),g._UZ(16,"ion-skeleton-text",31),g._UZ(17,"ion-skeleton-text",34),g._UZ(18,"ion-skeleton-text",35),g._UZ(19,"ion-skeleton-text",31),g._UZ(20,"ion-skeleton-text",36),g._UZ(21,"ion-skeleton-text",35),g._UZ(22,"ion-skeleton-text",37),g._UZ(23,"ion-skeleton-text",31),g._UZ(24,"ion-skeleton-text",32),g._UZ(25,"ion-skeleton-text",33),g._UZ(26,"ion-skeleton-text",31),g._UZ(27,"ion-skeleton-text",34),g._UZ(28,"ion-skeleton-text",35),g._UZ(29,"ion-skeleton-text",31),g._UZ(30,"ion-skeleton-text",36),g._UZ(31,"ion-skeleton-text",35),g._UZ(32,"ion-skeleton-text",37),g._UZ(33,"ion-skeleton-text",35),g._UZ(34,"ion-skeleton-text",31),g._UZ(35,"ion-skeleton-text",36),g._UZ(36,"ion-skeleton-text",35),g._UZ(37,"ion-skeleton-text",37),g._UZ(38,"ion-skeleton-text",31),g._UZ(39,"ion-skeleton-text",32),g._UZ(40,"ion-skeleton-text",33),g._UZ(41,"ion-skeleton-text",31),g._UZ(42,"ion-skeleton-text",34),g._UZ(43,"ion-skeleton-text",35),g._UZ(44,"ion-skeleton-text",31),g._UZ(45,"ion-skeleton-text",35),g._UZ(46,"ion-skeleton-text",31),g._UZ(47,"ion-skeleton-text",36),g._UZ(48,"ion-skeleton-text",35),g._UZ(49,"ion-skeleton-text",37),g._UZ(50,"ion-skeleton-text",31),g._UZ(51,"ion-skeleton-text",32),g._UZ(52,"ion-skeleton-text",33),g._UZ(53,"ion-skeleton-text",31),g._UZ(54,"ion-skeleton-text",34),g._UZ(55,"ion-skeleton-text",35),g._UZ(56,"ion-skeleton-text",31),g.qZA(),g.qZA(),g.qZA())}function Y(t,e){if(1&t){const t=g.EpF();g.TgZ(0,"ion-fab-button",38),g.NdJ("click",function(){return g.CHM(t),g.oxw().play()}),g._UZ(1,"ion-icon",39),g.qZA()}}const{Network:Q,Share:H}=d.Vn,B=[{path:"",component:(()=>{class t{constructor(t,e,i,o,n,s,a,r,l,c,d){this.activatedRoute=t,this.router=e,this.audioService=i,this.photoViewer=o,this.storage=n,this.routerService=s,this.firebaseService=a,this.toastController=r,this.alertController=l,this.loadingController=c,this.utils=d,this.soundReady=!1,this.favoritePosts=[],this.defaultHref="",this.textSize=15,this.isAdmin=!1,this.fileUploader=new f.bA({}),this.isPlaying=!1,this.online=!0,this.counter=0,this.isApp=!0}ngOnInit(){this.isApp=this.utils.isApp(),this.isApp&&Q.addListener("networkStatusChange",t=>{var e,i;this.online=t.connected,this.online||(null===(i=null===(e=this.post)||void 0===e?void 0:e.audio)||void 0===i?void 0:i.base64)&&this.audioService.loadNewAudio(this.post.audio.base64,this.post.title)}),this.loadData(),this.firebaseService.subscribeToAdmin().subscribe(t=>{this.isAdmin=t}),this.audioService.onTitleChange().subscribe(t=>{this.isPlaying=t.title===this.post.title})}ionViewWillEnter(){this.defaultHref=Boolean(this.router.routerState.snapshot.url.search("favorites")>-1)?"/tabs/favorites":"/tabs/posts",this.storage.get("text-size").then(t=>{this.textSize=t}),this.loadData(),this.firebaseService.incrementPostViews(this.activatedRoute.snapshot.paramMap.get("id")),this.intervalId=setInterval(()=>{this.counter=this.counter+1},1e3)}ionViewWillLeave(){this.firebaseService.incrementAnalyticsField(p.fg.POST_TIME,{duration:this.counter,postId:this.post.id,postTitle:this.post.title}),this.counter=0,clearInterval(this.intervalId)}loadData(){var t;return(0,r.mG)(this,void 0,void 0,function*(){yield this.firebaseService.loadCategories();const e=this.activatedRoute.snapshot.paramMap.get("id");yield this.storage.get("favoritePosts").then(t=>{t&&(this.favoritePosts=JSON.parse(t))});let i=!1;if(this.favoritePosts&&(i=Boolean(this.favoritePosts.find(t=>t.id.toString()===e))),i){const t=this.favoritePosts.find(t=>t.id.toString()==e);this.post=Object.assign(Object.assign({},t),{isFavorite:!0})}else this.post=yield this.firebaseService.getPost(e),this.post.articleWasRead=!0;this.isPlaying=this.audioService.getTitle()===this.post.title,this.online?this.post.audio&&this.audioService.loadNewAudio(this.post.audio.url,this.post.title):(null===(t=this.post.audio)||void 0===t?void 0:t.base64)&&this.audioService.loadNewAudio(this.post.audio.base64,this.post.title),setTimeout(()=>{for(const t of Array.from(document.querySelectorAll(".postContent img")))t.onclick=()=>{this.photoViewer.show(t.src)}},200)})}share(){return(0,r.mG)(this,void 0,void 0,function*(){yield H.share({title:"Ich habe einen interessanten Artikel aus dem Jugendkompass f\xfcr dich!",text:`Schau dir den Artikel "${this.post.title}" aus dem Jugendkompass an:`,url:`https://jugendkompass.com/tabs/posts/${this.post.id}`,dialogTitle:"Artikel teilen"})})}play(){this.audioService.playNew(),this.firebaseService.incrementAudioPlays(this.post.id)}setPostFavorite(){return(0,r.mG)(this,void 0,void 0,function*(){if(this.post.isFavorite)this.post.isFavorite=!1,this.post.base64Img=null,this.favoritePosts=this.favoritePosts.filter(t=>t.id!=this.post.id),this.favoritePosts&&this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(p.fg.FAVORITE_REMOVED);else{const t=yield this.loadingController.create({message:"Beitrag wird offline gespeichert..."});t.present(),this.post.postImg&&!this.post.postImg.source_url.startsWith("data")&&(yield this.firebaseService.getBase64FromUrl(this.post.postImg.source_url).then(t=>this.post.base64Img=t));for(const e of Array.from(document.querySelectorAll(".postContent img"))){const t=e.src;if(t.startsWith("data")){const e=yield this.firebaseService.getBase64FromUrl(t);this.post.content=this.post.content.replace(t,e)}}this.post.audio&&(this.post.audio.base64=yield this.firebaseService.getBase64FromUrl(this.post.audio.url,!1)),this.post.isFavorite=!0,this.favoritePosts.push(this.post),this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(p.fg.FAVORITE_ADDED),t.dismiss()}})}openFilteredList(t){this.routerService.setData(t),this.router.navigateByUrl("tabs/posts")}onAudioSelected(){return(0,r.mG)(this,void 0,void 0,function*(){this.fileUploader.queue&&0!==this.fileUploader.queue.length&&(this.file=this.fileUploader.queue[this.fileUploader.queue.length-1].file,this.openConfirmAudioUploadDialog())})}openConfirmAudioUploadDialog(){return(0,r.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Audioupload",message:`M\xf6chtest du die Audiodatei (${this.file.name}) f\xfcr diesen Artikel hochladen?`,buttons:[{text:"Ja",handler:()=>(0,r.mG)(this,void 0,void 0,function*(){const t=yield this.loadingController.create();t.present(),this.firebaseService.uploadAudio(this.file,this.post).then(e=>(0,r.mG)(this,void 0,void 0,function*(){const i=new h.Howl({html5:!0,src:[e.url],preload:!0});i.on("load",()=>{const o=Object.assign(Object.assign({},e),{duration:this.utils.getMinString(Math.round(i.duration()))});this.firebaseService.updatePost(this.post.id,{audio:o}).then(()=>(0,r.mG)(this,void 0,void 0,function*(){this.post.audio=o,this.audioService.loadNewAudio(this.post.audio.url,this.post.title),t.dismiss(),(yield this.toastController.create({duration:3e3,color:"success",message:"Datei erfolgreich hochgeladen!"})).present()})).catch(()=>(0,r.mG)(this,void 0,void 0,function*(){t.dismiss(),(yield this.toastController.create({duration:3e3,color:"danger",message:"Die Datei konnte nicht hochgeladen werden!"})).present()}))})})).catch(()=>{t.dismiss()})})},{text:"Abbrechen"}]})).present()})}}return t.\u0275fac=function(e){return new(e||t)(g.Y36(a.gz),g.Y36(a.F0),g.Y36(l.Q),g.Y36(c.h),g.Y36(x.Ke),g.Y36(Z.c),g.Y36(u.O),g.Y36(s.yF),g.Y36(s.Br),g.Y36(s.HT),g.Y36(m.c))},t.\u0275cmp=g.Xpm({type:t,selectors:[["app-post"]],viewQuery:function(t,e){if(1&t&&g.Gf(v,5),2&t){let t;g.iGM(t=g.CRH())&&(e.backButton=t.first)}},decls:17,vars:10,consts:[[1,"ion-no-border"],["header",""],["slot","start"],["text","",3,"defaultHref"],["backButton",""],["slot","end"],["accept","audio/mp3","type","file","ng2FileSelect","",2,"display","none",3,"uploader","change"],["audioSelector",""],[3,"click",4,"ngIf"],[3,"disabled","click",4,"ngIf"],["fullscreen","true","scrollEvents","true","appHideHeader","",3,"header","isList"],[4,"ngIf"],["vertical","bottom","horizontal","center","slot","fixed",1,"postPlayButton"],["style","margin: auto","size","small",3,"click",4,"ngIf"],[3,"click"],["slot","icon-only","name","cloud-upload"],["slot","icon-only","name","share-outline"],[3,"disabled","click"],["slot","icon-only",3,"name"],[1,"img-wrapper"],["id","headerImage",3,"src",4,"ngIf"],[1,"ion-text-center"],["color","medium"],[1,"ion-justify-content-center",2,"display","flex"],["class","subTitle",4,"ngIf"],[1,"text","postContent",3,"innerHTML"],["id","headerImage",3,"src"],[1,"subTitle"],["class","offline",4,"ngIf"],[1,"offline"],[1,"text"],["animated","",2,"width","100%"],["animated","",2,"width","70%"],["animated","",2,"width","80%"],["animated","",2,"width","60%"],["animated","",2,"width","40%"],["animated","",2,"width","50%"],["animated","",2,"width","10%"],["size","small",2,"margin","auto",3,"click"],["size","medium","name","play"]],template:function(t,e){if(1&t&&(g.TgZ(0,"ion-header",0,1),g.TgZ(2,"ion-toolbar"),g.TgZ(3,"ion-buttons",2),g._UZ(4,"ion-back-button",3,4),g.qZA(),g.TgZ(6,"ion-buttons",5),g.TgZ(7,"input",6,7),g.NdJ("change",function(){return e.onAudioSelected()}),g.qZA(),g.YNc(9,b,2,0,"ion-button",8),g.YNc(10,_,2,0,"ion-button",8),g.YNc(11,U,2,2,"ion-button",9),g.qZA(),g.qZA(),g.qZA(),g.TgZ(12,"ion-content",10),g.YNc(13,N,13,8,"div",11),g.YNc(14,F,57,0,"div",11),g.TgZ(15,"ion-fab",12),g.YNc(16,Y,2,0,"ion-fab-button",13),g.qZA(),g.qZA()),2&t){const t=g.MAs(1);g.xp6(4),g.Q6J("defaultHref",e.defaultHref),g.xp6(3),g.Q6J("uploader",e.fileUploader),g.xp6(2),g.Q6J("ngIf",e.isAdmin),g.xp6(1),g.Q6J("ngIf",e.isApp),g.xp6(1),g.Q6J("ngIf",e.isApp),g.xp6(1),g.Q6J("header",t)("isList",!1),g.xp6(1),g.Q6J("ngIf",e.post),g.xp6(1),g.Q6J("ngIf",!e.post),g.xp6(2),g.Q6J("ngIf",!e.isPlaying&&((null==e.post?null:e.post.audio)&&e.online||(null==e.post||null==e.post.audio?null:e.post.audio.base64)&&!e.online))}},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,f.C6,o.O5,s.W2,k.V,s.IJ,s.YG,s.gu,s.PM,s.FN,s.yW,s.CK,s.W4],styles:["ion-content[_ngcontent-%COMP%]{--padding-bottom: 2.5rem}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{overflow:visible;margin:2.5rem 1rem 2rem;position:relative;padding-top:60px}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding-bottom:1rem;padding-top:1.8rem}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .img-wrapper[_ngcontent-%COMP%]{background:var(--ion-color-dark-contrast);width:6rem;height:6rem;position:absolute;left:50%;top:-30px;transform:translate(-50%);box-shadow:#0000001f 0 4px 16px;border-radius:10px}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .img-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:10px;width:6rem;height:6rem}ion-content[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .subTitle[_ngcontent-%COMP%]{padding-top:.3rem}ion-content[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{padding:0 1rem}"]}),t})()}];let E=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[a.Bz.forChild(B)],a.Bz]}),t})();var D=i(88665);let z=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=g.oAB({type:t}),t.\u0275inj=g.cJS({imports:[[o.ez,n.u5,s.Pc,E,D.U,f.Ob]]}),t})()}}]);