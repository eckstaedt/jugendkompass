!function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}(self.webpackChunkjugendkompass=self.webpackChunkjugendkompass||[]).push([[4790],{14790:function(e,o,i){i.r(o),i.d(o,{PostPageModule:function(){return B}});var s,r=i(38583),a=i(90665),c=i(88786),u=i(90928),l=i(64762),d=i(96698),h=i(56818),p=i(66097),f=i(69526),g=i(60055),m=i(76321),v=i(16380),x=i(10639),k=i(38605),b=((s=function(){function e(){t(this,e)}return n(e,[{key:"setData",value:function(t){this.category=t}},{key:"getData",value:function(){return this.category}}]),e}()).\u0275fac=function(t){return new(t||s)},s.\u0275prov=x.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s),_=i(49860),Z=function(){var e=function(){function e(n,o,i){t(this,e),this.element=n,this.renderer=o,this.domCtrl=i}return n(e,[{key:"onScrollEvent",value:function(t){var e=this;this.header=this.element.nativeElement.getElementsByClassName("parallax")[0],this.domCtrl.read(function(){e.headerHeight=e.header.clientHeight});var n=t.detail.scrollTop;this.domCtrl.write(function(){n>0?(e.moveImage=n/5,e.scaleImage=1):(e.moveImage=n/1.4,e.scaleImage=-n/e.headerHeight+1),e.renderer.setStyle(e.header,"webkitTransform","translate3d(0, "+e.moveImage+"px, 0) scale("+e.scaleImage+","+e.scaleImage+")")})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(x.Y36(x.SBq),x.Y36(x.Qsj),x.Y36(c.Cb))},e.\u0275dir=x.lG2({type:e,selectors:[["","appParallaxHeader",""]],hostBindings:function(t,e){1&t&&x.NdJ("ionScroll",function(t){return e.onScrollEvent(t)})}}),e}(),U=["backButton"];function w(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"ion-button",19),x.NdJ("click",function(){return x.CHM(n),x.oxw(2).play()}),x._uU(1," Titel anh\xf6ren "),x.qZA()}}function C(t,e){if(1&t&&x._UZ(0,"img",20),2&t){var n=x.oxw(2);x.Q6J("src",n.post.base64Img?n.post.base64Img:n.post.postImg.source_url,x.LSH)}}function P(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"ion-button",19),x.NdJ("click",function(){x.CHM(n);var t=x.oxw(2);return t.openAusgabe(t.post.ausgabe)}),x._uU(1),x.qZA()}if(2&t){var o=x.oxw(2);x.xp6(1),x.hij(" ",o.post.ausgabe.name," ")}}function y(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"ion-button",19),x.NdJ("click",function(){x.CHM(n);var t=x.oxw(2);return t.openFilteredList(t.post.rubrik)}),x._uU(1),x.qZA()}if(2&t){var o=x.oxw(2);x.xp6(1),x.hij(" ",o.post.rubrik.name," ")}}function A(t,e){if(1&t&&(x.TgZ(0,"ion-button",21),x._uU(1),x.qZA()),2&t){var n=e.$implicit;x.xp6(1),x.hij(" ",n.name," ")}}function O(t,e){1&t&&(x.TgZ(0,"div"),x.TgZ(1,"div",22),x.TgZ(2,"p"),x._UZ(3,"ion-skeleton-text",23),x._UZ(4,"ion-skeleton-text",24),x._UZ(5,"ion-skeleton-text",25),x._UZ(6,"ion-skeleton-text",23),x._UZ(7,"ion-skeleton-text",26),x._UZ(8,"ion-skeleton-text",27),x._UZ(9,"ion-skeleton-text",23),x._UZ(10,"ion-skeleton-text",28),x._UZ(11,"ion-skeleton-text",27),x._UZ(12,"ion-skeleton-text",29),x._UZ(13,"ion-skeleton-text",23),x._UZ(14,"ion-skeleton-text",24),x._UZ(15,"ion-skeleton-text",25),x._UZ(16,"ion-skeleton-text",23),x._UZ(17,"ion-skeleton-text",26),x._UZ(18,"ion-skeleton-text",27),x._UZ(19,"ion-skeleton-text",23),x._UZ(20,"ion-skeleton-text",28),x._UZ(21,"ion-skeleton-text",27),x._UZ(22,"ion-skeleton-text",29),x._UZ(23,"ion-skeleton-text",23),x._UZ(24,"ion-skeleton-text",24),x._UZ(25,"ion-skeleton-text",25),x._UZ(26,"ion-skeleton-text",23),x._UZ(27,"ion-skeleton-text",26),x._UZ(28,"ion-skeleton-text",27),x._UZ(29,"ion-skeleton-text",23),x._UZ(30,"ion-skeleton-text",28),x._UZ(31,"ion-skeleton-text",27),x._UZ(32,"ion-skeleton-text",29),x._UZ(33,"ion-skeleton-text",27),x._UZ(34,"ion-skeleton-text",23),x._UZ(35,"ion-skeleton-text",28),x._UZ(36,"ion-skeleton-text",27),x._UZ(37,"ion-skeleton-text",29),x._UZ(38,"ion-skeleton-text",23),x._UZ(39,"ion-skeleton-text",24),x._UZ(40,"ion-skeleton-text",25),x._UZ(41,"ion-skeleton-text",23),x._UZ(42,"ion-skeleton-text",26),x._UZ(43,"ion-skeleton-text",27),x._UZ(44,"ion-skeleton-text",23),x._UZ(45,"ion-skeleton-text",27),x._UZ(46,"ion-skeleton-text",23),x._UZ(47,"ion-skeleton-text",28),x._UZ(48,"ion-skeleton-text",27),x._UZ(49,"ion-skeleton-text",29),x._UZ(50,"ion-skeleton-text",23),x._UZ(51,"ion-skeleton-text",24),x._UZ(52,"ion-skeleton-text",25),x._UZ(53,"ion-skeleton-text",23),x._UZ(54,"ion-skeleton-text",26),x._UZ(55,"ion-skeleton-text",27),x._UZ(56,"ion-skeleton-text",23),x.qZA(),x.qZA(),x.qZA())}function M(t,e){if(1&t){var n=x.EpF();x.TgZ(0,"div"),x.TgZ(1,"div",2),x.TgZ(2,"div",3),x._UZ(3,"ion-back-button",4,5),x.qZA(),x.TgZ(5,"div",6),x.TgZ(6,"div",7),x.TgZ(7,"ion-button",8),x.NdJ("click",function(){return x.CHM(n),x.oxw().setPostFavorite()}),x._UZ(8,"ion-icon",9),x.qZA(),x.TgZ(9,"ion-button",10),x.NdJ("click",function(){return x.CHM(n),x.oxw().share()}),x._UZ(10,"ion-icon",11),x.qZA(),x.qZA(),x.TgZ(11,"div",12),x.YNc(12,w,2,0,"ion-button",13),x.qZA(),x.qZA(),x.YNc(13,C,1,1,"img",14),x.qZA(),x.TgZ(14,"div",15),x.YNc(15,P,2,1,"ion-button",13),x.YNc(16,y,2,1,"ion-button",13),x.YNc(17,A,2,1,"ion-button",16),x.TgZ(18,"h4",17),x._uU(19),x.qZA(),x._UZ(20,"div",18),x.qZA(),x.YNc(21,O,57,0,"div",1),x.qZA()}if(2&t){var o=x.oxw();x.xp6(3),x.Q6J("defaultHref",o.defaultHref),x.xp6(4),x.Q6J("disabled",!(null!=o.post&&o.post.id)),x.xp6(1),x.Q6J("name",null!=o.post&&o.post.isFavorite?"star":"star-outline"),x.xp6(4),x.Q6J("ngIf",!o.isPlaying&&((null==o.post?null:o.post.audio)&&o.online||(null==o.post||null==o.post.audio?null:o.post.audio.base64)&&!o.online)),x.xp6(1),x.Q6J("ngIf",o.post.postImg||o.post.base64Img),x.xp6(2),x.Q6J("ngIf",o.post.ausgabe),x.xp6(1),x.Q6J("ngIf",o.post.rubrik),x.xp6(1),x.Q6J("ngForOf",o.post.tags),x.xp6(2),x.Oqu(o.post.title),x.xp6(1),x.Udp("font-size",o.textSize,"px"),x.Q6J("innerHTML",o.post.content,x.oJD),x.xp6(1),x.Q6J("ngIf",!o.post)}}var S=[{path:"",component:function(){var e=function(){function e(n,o,i,s,r,a,c,u,l,d,h,p,f){t(this,e),this.activatedRoute=n,this.router=o,this.audioService=i,this.photoViewer=s,this.platform=r,this.actionSheetController=a,this.storage=c,this.routerService=u,this.firebaseService=l,this.toastController=d,this.alertController=h,this.loadingController=p,this.utils=f,this.soundReady=!1,this.favoritePosts=[],this.defaultHref="",this.textSize=15,this.isAdmin=!1,this.fileUploader=new m.bA({}),this.isPlaying=!1,this.online=!0,this.counter=0,this.isApp=!0}return n(e,[{key:"ngOnInit",value:function(){var t=this;this.isApp=this.utils.isApp(),this.loadData(),this.firebaseService.subscribeToAdmin().subscribe(function(e){t.isAdmin=e})}},{key:"ionViewWillEnter",value:function(){var t=this;this.defaultHref=Boolean(this.router.routerState.snapshot.url.search("favorites")>-1)?"/tabs/favorites":"/tabs/lesen",this.storage.get("text-size").then(function(e){t.textSize=e}),this.loadData(),this.firebaseService.incrementPostViews(this.activatedRoute.snapshot.paramMap.get("id")),this.intervalId=setInterval(function(){t.counter=t.counter+1},1e3)}},{key:"ionViewWillLeave",value:function(){this.firebaseService.incrementAnalyticsField(f.fg.POST_TIME,{duration:this.counter,postId:this.post.id,postTitle:this.post.title}),this.counter=0,clearInterval(this.intervalId)}},{key:"loadData",value:function(){var t;return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var n,o,i,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.firebaseService.loadCategories();case 2:return n=this.activatedRoute.snapshot.paramMap.get("id"),e.next=5,this.storage.get("favoritePosts").then(function(t){t&&(s.favoritePosts=JSON.parse(t))});case 5:if(o=!1,this.favoritePosts&&(o=Boolean(this.favoritePosts.find(function(t){return t.id.toString()===n}))),!o){e.next=11;break}i=this.favoritePosts.find(function(t){return t.id.toString()==n}),this.post=Object.assign(Object.assign({},i),{isFavorite:!0}),e.next=15;break;case 11:return e.next=13,this.firebaseService.getPost(n);case 13:this.post=e.sent,this.post.articleWasRead=!0;case 15:this.isPlaying=this.audioService.getTitle()===this.post.title,this.online?this.post.audio&&this.audioService.loadNewAudio(this.post.audio.url,this.post):(null===(t=this.post.audio)||void 0===t?void 0:t.base64)&&this.audioService.loadNewAudio(this.post.audio.base64,this.post),setTimeout(function(){for(var t=function(){var t=n[e];t.onclick=function(){s.photoViewer.show(t.src)}},e=0,n=Array.from(document.querySelectorAll(".postContent img"));e<n.length;e++)t()},200);case 16:case"end":return e.stop()}},e,this)}))}},{key:"share",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.m.share({title:"Artikel teilen",text:this.post.title,url:"https://jugendkompass.com/tabs/lesen/posts/".concat(this.post.id),dialogTitle:"Artikel teilen"});case 2:case"end":return t.stop()}},t,this)}))}},{key:"play",value:function(){this.audioService.playNew(),this.firebaseService.incrementAudioPlays(this.post.id)}},{key:"setPostFavorite",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n,o,i,s,r,a=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.post.isFavorite){t.next=4;break}this.post.isFavorite=!1,this.post.base64Img=null,this.favoritePosts=this.favoritePosts.filter(function(t){return t.id!=a.post.id}),this.favoritePosts&&this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(f.fg.FAVORITE_REMOVED),t.next=34;break;case 4:return t.next=6,this.loadingController.create({message:"Beitrag wird offline gespeichert..."});case 6:if((e=t.sent).present(),t.t0=this.post.postImg&&!this.post.postImg.source_url.startsWith("data"),!t.t0){t.next=12;break}return t.next=12,this.firebaseService.getBase64FromUrl(this.post.postImg.source_url).then(function(t){return a.post.base64Img=t});case 12:n=0,o=Array.from(document.querySelectorAll(".postContent img"));case 13:if(!(n<o.length)){t.next=24;break}if(i=o[n],!(s=i.src).startsWith("data")){t.next=21;break}return t.next=19,this.firebaseService.getBase64FromUrl(s);case 19:r=t.sent,this.post.content=this.post.content.replace(s,r);case 21:n++,t.next=13;break;case 24:if(t.t1=this.post.audio,!t.t1){t.next=29;break}return t.next=28,this.firebaseService.getBase64FromUrl(this.post.audio.url,!1);case 28:this.post.audio.base64=t.sent;case 29:this.post.isFavorite=!0,this.favoritePosts.push(this.post),this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(f.fg.FAVORITE_ADDED),e.dismiss();case 34:case"end":return t.stop()}},t,this)}))}},{key:"openFilteredList",value:function(t){this.routerService.setData(t),this.router.navigateByUrl("tabs/lesen")}},{key:"openAusgabe",value:function(t){this.router.navigateByUrl("tabs/lesen/ausgabe/".concat(t.id))}},{key:"onAudioSelected",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:this.fileUploader.queue&&0!==this.fileUploader.queue.length&&(this.file=this.fileUploader.queue[this.fileUploader.queue.length-1].file,this.openConfirmAudioUploadDialog());case 1:case"end":return t.stop()}},t,this)}))}},{key:"openConfirmAudioUploadDialog",value:function(){return(0,l.mG)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.alertController.create({header:"Audioupload",message:"M\xf6chtest du die Audiodatei (".concat(this.file.name,") f\xfcr diesen Artikel hochladen?"),buttons:[{text:"Ja",handler:function(){return(0,l.mG)(e,void 0,void 0,regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.loadingController.create();case 2:(e=t.sent).present(),this.firebaseService.uploadAudio(this.file).then(function(t){return(0,l.mG)(n,void 0,void 0,regeneratorRuntime.mark(function n(){var o,i=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(o=new g.Howl({html5:!0,src:[t.url],preload:!0})).on("load",function(){var n=Object.assign(Object.assign({},t),{duration:i.utils.getMinString(Math.round(o.duration()))});i.firebaseService.updatePost(i.post.id,{audio:n}).then(function(){return(0,l.mG)(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.post.audio=n,this.audioService.loadNewAudio(this.post.audio.url,this.post),e.dismiss(),t.next=5,this.toastController.create({duration:3e3,color:"success",message:"Datei erfolgreich hochgeladen!"});case 5:t.sent.present();case 6:case"end":return t.stop()}},t,this)}))}).catch(function(){return(0,l.mG)(i,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.dismiss(),t.next=3,this.toastController.create({duration:3e3,color:"danger",message:"Die Datei konnte nicht hochgeladen werden!"});case 3:t.sent.present();case 4:case"end":return t.stop()}},t,this)}))})});case 2:case"end":return n.stop()}},n)}))}).catch(function(){e.dismiss()});case 4:case"end":return t.stop()}},t,this)}))}},{text:"Abbrechen"}]});case 2:return t.next=4,t.sent.present();case 4:case"end":return t.stop()}},t,this)}))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(x.Y36(u.gz),x.Y36(u.F0),x.Y36(d.Q),x.Y36(h.h),x.Y36(c.t4),x.Y36(c.BX),x.Y36(k.Ke),x.Y36(b),x.Y36(p.O),x.Y36(c.yF),x.Y36(c.Br),x.Y36(c.HT),x.Y36(_.c))},e.\u0275cmp=x.Xpm({type:e,selectors:[["app-post"]],viewQuery:function(t,e){var n;(1&t&&x.Gf(U,5),2&t)&&(x.iGM(n=x.CRH())&&(e.backButton=n.first))},decls:2,vars:1,consts:[["appParallaxHeader","","fullscreen","true","scrollEvents","true"],[4,"ngIf"],["id","header",1,"parallax"],[1,"topButtons"],["text","",3,"defaultHref"],["backButton",""],[1,"bottomButtons"],[1,"leftButtons"],["shape","circle","size","small",3,"disabled","click"],["slot","icon-only",3,"name"],["shape","circle","size","small",3,"click"],["slot","icon-only","name","share-outline"],[1,"rightButtons"],["shape","round","size","small",3,"click",4,"ngIf"],["id","headerImage",3,"src",4,"ngIf"],[1,"mainContent"],["size","small","shape","round",4,"ngFor","ngForOf"],[1,"title"],[1,"text","postContent",3,"innerHTML"],["shape","round","size","small",3,"click"],["id","headerImage",3,"src"],["size","small","shape","round"],[1,"text"],["animated","",2,"width","100%"],["animated","",2,"width","70%"],["animated","",2,"width","80%"],["animated","",2,"width","60%"],["animated","",2,"width","40%"],["animated","",2,"width","50%"],["animated","",2,"width","10%"]],template:function(t,e){1&t&&(x.TgZ(0,"ion-content",0),x.YNc(1,M,22,13,"div",1),x.qZA()),2&t&&(x.xp6(1),x.Q6J("ngIf",e.post))},directives:[c.W2,Z,r.O5,c.oU,c.cs,c.YG,c.gu,r.sg,c.CK],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: transparent;padding:1rem}ion-content[_ngcontent-%COMP%]{--padding-bottom: 2.5rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]{position:relative;z-index:9}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-bottom:1px solid var(--ion-color-light-shade)}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .topButtons[_ngcontent-%COMP%]{position:absolute;top:1rem;display:flex;width:100%;justify-content:space-between;padding:1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]{position:absolute;bottom:1rem;display:flex;width:100%;justify-content:space-between;padding:0 1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]   .leftButtons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-medium-rgb), .8)}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]   .rightButtons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:35px;font-size:1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   #headerImage[_ngcontent-%COMP%]{border-radius:0 0 2rem 2rem}ion-content[_ngcontent-%COMP%]   .mainContent[_ngcontent-%COMP%]{padding:1rem 1.5rem 1.5rem}ion-content[_ngcontent-%COMP%]   .mainContent[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-medium-rgb), 1)}"]}),e}()}],I=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x.oAB({type:e}),e.\u0275inj=x.cJS({imports:[[u.Bz.forChild(S)],u.Bz]}),e}(),T=i(88665),B=function(){var e=function e(){t(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x.oAB({type:e}),e.\u0275inj=x.cJS({imports:[[r.ez,a.u5,c.Pc,I,T.U,m.Ob]]}),e}()}}])}();