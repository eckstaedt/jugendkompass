"use strict";(self.webpackChunkjugendkompass=self.webpackChunkjugendkompass||[]).push([[4790],{14790:function(t,e,o){o.r(e),o.d(e,{PostPageModule:function(){return S}});var i=o(38583),n=o(90665),s=o(88786),r=o(90928),a=o(64762),l=o(96698),c=o(56818),d=o(66097),h=o(69526),u=o(60055),p=o(76321),g=o(16380),f=o(10639),m=o(38605);let v=(()=>{class t{constructor(){}setData(t){this.category=t}getData(){return this.category}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var _=o(49860);let x=(()=>{class t{constructor(t,e,o){this.element=t,this.renderer=e,this.domCtrl=o}onScrollEvent(t){this.header=this.element.nativeElement.getElementsByClassName("parallax")[0],this.domCtrl.read(()=>{this.headerHeight=this.header.clientHeight});const e=t.detail.scrollTop;this.domCtrl.write(()=>{e>0?(this.moveImage=e/5,this.scaleImage=1):(this.moveImage=e/1.4,this.scaleImage=-e/this.headerHeight+1),this.renderer.setStyle(this.header,"webkitTransform","translate3d(0, "+this.moveImage+"px, 0) scale("+this.scaleImage+","+this.scaleImage+")")})}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(f.SBq),f.Y36(f.Qsj),f.Y36(s.Cb))},t.\u0275dir=f.lG2({type:t,selectors:[["","appParallaxHeader",""]],hostBindings:function(t,e){1&t&&f.NdJ("ionScroll",function(t){return e.onScrollEvent(t)})}}),t})();const b=["backButton"];function Z(t,e){if(1&t){const t=f.EpF();f.TgZ(0,"ion-button",19),f.NdJ("click",function(){return f.CHM(t),f.oxw(2).play()}),f._uU(1," Titel anh\xf6ren "),f.qZA()}}function k(t,e){if(1&t&&f._UZ(0,"img",20),2&t){const t=f.oxw(2);f.Q6J("src",t.post.base64Img?t.post.base64Img:t.post.postImg.source_url,f.LSH)}}function U(t,e){if(1&t){const t=f.EpF();f.TgZ(0,"ion-button",19),f.NdJ("click",function(){f.CHM(t);const e=f.oxw(2);return e.openAusgabe(e.post.ausgabe)}),f._uU(1),f.qZA()}if(2&t){const t=f.oxw(2);f.xp6(1),f.hij(" ",t.post.ausgabe.name," ")}}function C(t,e){if(1&t){const t=f.EpF();f.TgZ(0,"ion-button",19),f.NdJ("click",function(){f.CHM(t);const e=f.oxw(2);return e.openFilteredList(e.post.rubrik)}),f._uU(1),f.qZA()}if(2&t){const t=f.oxw(2);f.xp6(1),f.hij(" ",t.post.rubrik.name," ")}}function P(t,e){if(1&t&&(f.TgZ(0,"ion-button",21),f._uU(1),f.qZA()),2&t){const t=e.$implicit;f.xp6(1),f.hij(" ",t.name," ")}}function A(t,e){1&t&&(f.TgZ(0,"div"),f.TgZ(1,"div",22),f.TgZ(2,"p"),f._UZ(3,"ion-skeleton-text",23),f._UZ(4,"ion-skeleton-text",24),f._UZ(5,"ion-skeleton-text",25),f._UZ(6,"ion-skeleton-text",23),f._UZ(7,"ion-skeleton-text",26),f._UZ(8,"ion-skeleton-text",27),f._UZ(9,"ion-skeleton-text",23),f._UZ(10,"ion-skeleton-text",28),f._UZ(11,"ion-skeleton-text",27),f._UZ(12,"ion-skeleton-text",29),f._UZ(13,"ion-skeleton-text",23),f._UZ(14,"ion-skeleton-text",24),f._UZ(15,"ion-skeleton-text",25),f._UZ(16,"ion-skeleton-text",23),f._UZ(17,"ion-skeleton-text",26),f._UZ(18,"ion-skeleton-text",27),f._UZ(19,"ion-skeleton-text",23),f._UZ(20,"ion-skeleton-text",28),f._UZ(21,"ion-skeleton-text",27),f._UZ(22,"ion-skeleton-text",29),f._UZ(23,"ion-skeleton-text",23),f._UZ(24,"ion-skeleton-text",24),f._UZ(25,"ion-skeleton-text",25),f._UZ(26,"ion-skeleton-text",23),f._UZ(27,"ion-skeleton-text",26),f._UZ(28,"ion-skeleton-text",27),f._UZ(29,"ion-skeleton-text",23),f._UZ(30,"ion-skeleton-text",28),f._UZ(31,"ion-skeleton-text",27),f._UZ(32,"ion-skeleton-text",29),f._UZ(33,"ion-skeleton-text",27),f._UZ(34,"ion-skeleton-text",23),f._UZ(35,"ion-skeleton-text",28),f._UZ(36,"ion-skeleton-text",27),f._UZ(37,"ion-skeleton-text",29),f._UZ(38,"ion-skeleton-text",23),f._UZ(39,"ion-skeleton-text",24),f._UZ(40,"ion-skeleton-text",25),f._UZ(41,"ion-skeleton-text",23),f._UZ(42,"ion-skeleton-text",26),f._UZ(43,"ion-skeleton-text",27),f._UZ(44,"ion-skeleton-text",23),f._UZ(45,"ion-skeleton-text",27),f._UZ(46,"ion-skeleton-text",23),f._UZ(47,"ion-skeleton-text",28),f._UZ(48,"ion-skeleton-text",27),f._UZ(49,"ion-skeleton-text",29),f._UZ(50,"ion-skeleton-text",23),f._UZ(51,"ion-skeleton-text",24),f._UZ(52,"ion-skeleton-text",25),f._UZ(53,"ion-skeleton-text",23),f._UZ(54,"ion-skeleton-text",26),f._UZ(55,"ion-skeleton-text",27),f._UZ(56,"ion-skeleton-text",23),f.qZA(),f.qZA(),f.qZA())}function y(t,e){if(1&t){const t=f.EpF();f.TgZ(0,"div"),f.TgZ(1,"div",2),f.TgZ(2,"div",3),f._UZ(3,"ion-back-button",4,5),f.qZA(),f.TgZ(5,"div",6),f.TgZ(6,"div",7),f.TgZ(7,"ion-button",8),f.NdJ("click",function(){return f.CHM(t),f.oxw().setPostFavorite()}),f._UZ(8,"ion-icon",9),f.qZA(),f.TgZ(9,"ion-button",10),f.NdJ("click",function(){return f.CHM(t),f.oxw().share()}),f._UZ(10,"ion-icon",11),f.qZA(),f.qZA(),f.TgZ(11,"div",12),f.YNc(12,Z,2,0,"ion-button",13),f.qZA(),f.qZA(),f.YNc(13,k,1,1,"img",14),f.qZA(),f.TgZ(14,"div",15),f.YNc(15,U,2,1,"ion-button",13),f.YNc(16,C,2,1,"ion-button",13),f.YNc(17,P,2,1,"ion-button",16),f.TgZ(18,"h4",17),f._uU(19),f.qZA(),f._UZ(20,"div",18),f.qZA(),f.YNc(21,A,57,0,"div",1),f.qZA()}if(2&t){const t=f.oxw();f.xp6(3),f.Q6J("defaultHref",t.defaultHref),f.xp6(4),f.Q6J("disabled",!(null!=t.post&&t.post.id)),f.xp6(1),f.Q6J("name",null!=t.post&&t.post.isFavorite?"star":"star-outline"),f.xp6(4),f.Q6J("ngIf",!t.isPlaying&&((null==t.post?null:t.post.audio)&&t.online||(null==t.post||null==t.post.audio?null:t.post.audio.base64)&&!t.online)),f.xp6(1),f.Q6J("ngIf",t.post.postImg||t.post.base64Img),f.xp6(2),f.Q6J("ngIf",t.post.ausgabe),f.xp6(1),f.Q6J("ngIf",t.post.rubrik),f.xp6(1),f.Q6J("ngForOf",t.post.tags),f.xp6(2),f.Oqu(t.post.title),f.xp6(1),f.Udp("font-size",t.textSize,"px"),f.Q6J("innerHTML",t.post.content,f.oJD),f.xp6(1),f.Q6J("ngIf",!t.post)}}const O=[{path:"",component:(()=>{class t{constructor(t,e,o,i,n,s,r,a,l,c,d,h,u){this.activatedRoute=t,this.router=e,this.audioService=o,this.photoViewer=i,this.platform=n,this.actionSheetController=s,this.storage=r,this.routerService=a,this.firebaseService=l,this.toastController=c,this.alertController=d,this.loadingController=h,this.utils=u,this.soundReady=!1,this.favoritePosts=[],this.defaultHref="",this.textSize=15,this.isAdmin=!1,this.fileUploader=new p.bA({}),this.isPlaying=!1,this.online=!0,this.counter=0,this.isApp=!0}ngOnInit(){this.isApp=this.utils.isApp(),this.loadData(),this.firebaseService.subscribeToAdmin().subscribe(t=>{this.isAdmin=t})}ionViewWillEnter(){this.defaultHref=Boolean(this.router.routerState.snapshot.url.search("favorites")>-1)?"/tabs/favorites":"/tabs/lesen",this.storage.get("text-size").then(t=>{this.textSize=t}),this.loadData(),this.firebaseService.incrementPostViews(this.activatedRoute.snapshot.paramMap.get("id")),this.intervalId=setInterval(()=>{this.counter=this.counter+1},1e3)}ionViewWillLeave(){this.firebaseService.incrementAnalyticsField(h.fg.POST_TIME,{duration:this.counter,postId:this.post.id,postTitle:this.post.title}),this.counter=0,clearInterval(this.intervalId)}loadData(){var t;return(0,a.mG)(this,void 0,void 0,function*(){yield this.firebaseService.loadCategories();const e=this.activatedRoute.snapshot.paramMap.get("id");yield this.storage.get("favoritePosts").then(t=>{t&&(this.favoritePosts=JSON.parse(t))});let o=!1;if(this.favoritePosts&&(o=Boolean(this.favoritePosts.find(t=>t.id.toString()===e))),o){const t=this.favoritePosts.find(t=>t.id.toString()==e);this.post=Object.assign(Object.assign({},t),{isFavorite:!0})}else this.post=yield this.firebaseService.getPost(e),this.post.articleWasRead=!0;this.isPlaying=this.audioService.getTitle()===this.post.title,this.online?this.post.audio&&this.audioService.loadNewAudio(this.post.audio.url,this.post):(null===(t=this.post.audio)||void 0===t?void 0:t.base64)&&this.audioService.loadNewAudio(this.post.audio.base64,this.post),setTimeout(()=>{for(const t of Array.from(document.querySelectorAll(".postContent img")))t.onclick=()=>{this.photoViewer.show(t.src)}},200)})}share(){return(0,a.mG)(this,void 0,void 0,function*(){yield g.m.share({title:"Artikel teilen",text:this.post.title,url:`https://jugendkompass.com/tabs/lesen/posts/${this.post.id}`,dialogTitle:"Artikel teilen"})})}play(){this.audioService.playNew(),this.firebaseService.incrementAudioPlays(this.post.id)}setPostFavorite(){return(0,a.mG)(this,void 0,void 0,function*(){if(this.post.isFavorite)this.post.isFavorite=!1,this.post.base64Img=null,this.favoritePosts=this.favoritePosts.filter(t=>t.id!=this.post.id),this.favoritePosts&&this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(h.fg.FAVORITE_REMOVED);else{const t=yield this.loadingController.create({message:"Beitrag wird offline gespeichert..."});t.present(),this.post.postImg&&!this.post.postImg.source_url.startsWith("data")&&(yield this.firebaseService.getBase64FromUrl(this.post.postImg.source_url).then(t=>this.post.base64Img=t));for(const e of Array.from(document.querySelectorAll(".postContent img"))){const t=e.src;if(t.startsWith("data")){const e=yield this.firebaseService.getBase64FromUrl(t);this.post.content=this.post.content.replace(t,e)}}this.post.audio&&(this.post.audio.base64=yield this.firebaseService.getBase64FromUrl(this.post.audio.url,!1)),this.post.isFavorite=!0,this.favoritePosts.push(this.post),this.storage.set("favoritePosts",JSON.stringify(this.favoritePosts)),this.firebaseService.incrementAnalyticsField(h.fg.FAVORITE_ADDED),t.dismiss()}})}openFilteredList(t){this.routerService.setData(t),this.router.navigateByUrl("tabs/lesen")}openAusgabe(t){this.router.navigateByUrl(`tabs/lesen/ausgabe/${t.id}`)}onAudioSelected(){return(0,a.mG)(this,void 0,void 0,function*(){this.fileUploader.queue&&0!==this.fileUploader.queue.length&&(this.file=this.fileUploader.queue[this.fileUploader.queue.length-1].file,this.openConfirmAudioUploadDialog())})}openConfirmAudioUploadDialog(){return(0,a.mG)(this,void 0,void 0,function*(){yield(yield this.alertController.create({header:"Audioupload",message:`M\xf6chtest du die Audiodatei (${this.file.name}) f\xfcr diesen Artikel hochladen?`,buttons:[{text:"Ja",handler:()=>(0,a.mG)(this,void 0,void 0,function*(){const t=yield this.loadingController.create();t.present(),this.firebaseService.uploadAudio(this.file).then(e=>(0,a.mG)(this,void 0,void 0,function*(){const o=new u.Howl({html5:!0,src:[e.url],preload:!0});o.on("load",()=>{const i=Object.assign(Object.assign({},e),{duration:this.utils.getMinString(Math.round(o.duration()))});this.firebaseService.updatePost(this.post.id,{audio:i}).then(()=>(0,a.mG)(this,void 0,void 0,function*(){this.post.audio=i,this.audioService.loadNewAudio(this.post.audio.url,this.post),t.dismiss(),(yield this.toastController.create({duration:3e3,color:"success",message:"Datei erfolgreich hochgeladen!"})).present()})).catch(()=>(0,a.mG)(this,void 0,void 0,function*(){t.dismiss(),(yield this.toastController.create({duration:3e3,color:"danger",message:"Die Datei konnte nicht hochgeladen werden!"})).present()}))})})).catch(()=>{t.dismiss()})})},{text:"Abbrechen"}]})).present()})}}return t.\u0275fac=function(e){return new(e||t)(f.Y36(r.gz),f.Y36(r.F0),f.Y36(l.Q),f.Y36(c.h),f.Y36(s.t4),f.Y36(s.BX),f.Y36(m.Ke),f.Y36(v),f.Y36(d.O),f.Y36(s.yF),f.Y36(s.Br),f.Y36(s.HT),f.Y36(_.c))},t.\u0275cmp=f.Xpm({type:t,selectors:[["app-post"]],viewQuery:function(t,e){if(1&t&&f.Gf(b,5),2&t){let t;f.iGM(t=f.CRH())&&(e.backButton=t.first)}},decls:2,vars:1,consts:[["appParallaxHeader","","fullscreen","true","scrollEvents","true"],[4,"ngIf"],["id","header",1,"parallax"],[1,"topButtons"],["text","",3,"defaultHref"],["backButton",""],[1,"bottomButtons"],[1,"leftButtons"],["shape","circle","size","small",3,"disabled","click"],["slot","icon-only",3,"name"],["shape","circle","size","small",3,"click"],["slot","icon-only","name","share-outline"],[1,"rightButtons"],["shape","round","size","small",3,"click",4,"ngIf"],["id","headerImage",3,"src",4,"ngIf"],[1,"mainContent"],["size","small","shape","round",4,"ngFor","ngForOf"],[1,"title"],[1,"text","postContent",3,"innerHTML"],["shape","round","size","small",3,"click"],["id","headerImage",3,"src"],["size","small","shape","round"],[1,"text"],["animated","",2,"width","100%"],["animated","",2,"width","70%"],["animated","",2,"width","80%"],["animated","",2,"width","60%"],["animated","",2,"width","40%"],["animated","",2,"width","50%"],["animated","",2,"width","10%"]],template:function(t,e){1&t&&(f.TgZ(0,"ion-content",0),f.YNc(1,y,22,13,"div",1),f.qZA()),2&t&&(f.xp6(1),f.Q6J("ngIf",e.post))},directives:[s.W2,x,i.O5,s.oU,s.cs,s.YG,s.gu,i.sg,s.CK],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: transparent;padding:1rem}ion-content[_ngcontent-%COMP%]{--padding-bottom: 2.5rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]{position:relative;z-index:9}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-bottom:1px solid var(--ion-color-light-shade)}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .topButtons[_ngcontent-%COMP%]{position:absolute;top:1rem;display:flex;width:100%;justify-content:space-between;padding:1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]{position:absolute;bottom:1rem;display:flex;width:100%;justify-content:space-between;padding:0 1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]   .leftButtons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-medium-rgb), .8)}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   .bottomButtons[_ngcontent-%COMP%]   .rightButtons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:35px;font-size:1rem}ion-content[_ngcontent-%COMP%]   #header[_ngcontent-%COMP%]   #headerImage[_ngcontent-%COMP%]{border-radius:0 0 2rem 2rem}ion-content[_ngcontent-%COMP%]   .mainContent[_ngcontent-%COMP%]{padding:1rem 1.5rem 1.5rem}ion-content[_ngcontent-%COMP%]   .mainContent[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: rgba(var(--ion-color-medium-rgb), 1)}"]}),t})()}];let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[r.Bz.forChild(O)],r.Bz]}),t})();var w=o(88665);let S=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[[i.ez,n.u5,s.Pc,M,w.U,p.Ob]]}),t})()}}]);